#!/usr/bin/env ruby

require 'bundler/setup'
require 'benchmark'
require 'lug/logger'
require 'lug/tty_logger'
require 'lug/standard'
require 'logger'

null_io = File.open(File::NULL, 'a')
N = 100_000

Benchmark.bmbm do |x|
  logger = Logger.new(null_io)
  x.report('Logger#debug') do
    N.times { |i| logger.debug(i) }
  end

  lug = Lug::Logger.new(nil, null_io)
  x.report('Lug::Logger#log') do
    N.times { |i| lug << i }
  end

  lug = Lug::Logger.new(:main, null_io)
  x.report('Lug::Logger#log (w/ns)') do
    N.times { |i| lug << i }
  end

  lug = Lug::TtyLogger.new(nil, null_io)
  x.report('Lug::TtyLogger#log') do
    N.times { |i| lug << i }
  end

  lug = Lug::TtyLogger.new(:main, null_io)
  x.report('Lug::TtyLogger#log (w/ns)') do
    N.times { |i| lug << i }
  end

  # Include standard Logger methods mixin
  Lug::Logger.include(Lug::Standard)

  lug = Lug::Logger.new(nil, null_io)
  x.report('Lug::Logger#debug + Standard') do
    N.times { |i| lug.debug(i) }
  end

  lug = Lug::Logger.new(:main, null_io)
  x.report('Lug::Logger#debug + Standard (w/ns)') do
    N.times { |i| lug.debug(i) }
  end

  lug = Lug::TtyLogger.new(nil, null_io)
  x.report('Lug::TtyLogger#debug + Standard') do
    N.times { |i| lug.debug(i) }
  end

  lug = Lug::TtyLogger.new(:main, null_io)
  x.report('Lug::TtyLogger#debug + Standard (w/ns)') do
    N.times { |i| lug.debug(i) }
  end
end
